<!--// This file is part of ThessOpenTrip.
// 
// ThessOpenTrip is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
// 
// ThessOpenTrip is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
// 
// You should have received a copy of the GNU General Public License
// along with ThessOpenTrip. If not, see <http://www.gnu.org/licenses/>.-->

<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
        
        <style>
            body {
                padding-top: 50px;
                //padding-bottom: 20px;
                //margin-left: 20px;
                //margin-right: 20px;
                background: url('img/background2.png');// no-repeat scroll 0 0 / 100% 100% transparent !important;
                //background: url('img/traffic generation.jpg');// no-repeat scroll 0 0 / 100% 100% transparent !important;
                background-size: 100% 100%;
                background-position:100% 100%;
                background-repeat: no-repeat;
                padding-bottom: 0px !important;
                margin-bottom: 0px !important;
                width: 100%;
                height: 100%;
            }
        </style>
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/main.css">
        <link href="css/wrap.css" rel="stylesheet" type="text/css"/>

        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
        
<!--        Include scritps-->
<script src="js/vendor/alertify.js/alertify.min.js"></script>
<link rel="stylesheet" href="js/vendor/alertify.js/alertify.core.css">
<link rel="stylesheet" href="js/vendor/alertify.js/alertify.default.css">


<script src="js/functions.js"></script>
        
        
        <!-- GENERAL PAGE NAVIGATION SCRIPTS -->
        <script type="text/javascript" charset="utf-8">


             function callAnothePage(page)
             {
                window.location = page;
             }
             
             function forgotPassword(){
                var div=document.getElementById('passwordForgot');
                div.className="apollo-forgotten-password";
                var divL=document.getElementById('loginForm');
                divL.className="hide";
             }
             
                        

        </script>
    </head>
    <body>
     <div id="wrap">
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
        <!-- 
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
         <span class="sr-only">Toggle navigation</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
          </button>
           -->
            <a class="navbar-brand" href="index.html"><i class="fa fa-home fa-2x"></i></a>
        </div>
<!--    <div id="navbar" class="navbar-collapse collapse navbar-right">
         <ul class="list-group">
            <li class="list-group-item"><span class="fa fa-user-md fa-2x"></span><i class="whiteLetters"> worker</i></li>
            <li class="divider"></li>
            <li class="list-group-item"><span class="fa fa-key fa-2x"></span><i class=""> User API keys </i></li>
            <li class="list-group-item"><span class="fa fa-wrench fa-2x"></span><i class="">Settings</i></li>
            <li class="list-group-item"><span class="fa fa-signal fa-2x"></span><i class=""> Dashboard </i></li> 
            <li class="divider"></li>
            <li class="list-group-item" onclick="logout()"><span class="fa fa-sign-out fa-2x"></span><i class="whiteLetters"> logout </i></li>
          </ul>
        
        </div>   -->
        <!--/.navbar-collapse -->
      </div>
    </nav>   
    <div class="container">
    <p>&nbsp;</p>
        <div id="signupform">        
        <div class="row transbox">
            <h4>Sign up</h4>
            <div class="col-sm-11">

                 <div class="form-group">
                                <label for="InputName">Name</label>
                                <input class="form-control required" id="InputName" maxlength="24" placeholder="Enter your name" re>
                            </div>
                            <div class="form-group">
                                <label for="InputSName">Surname</label>
                                <input class="form-control required" id="InputSName" maxlength="24" placeholder="Enter your surname" required>
                            </div>

                            <div class="form-group">
                                <label for="InputEmail1">Email address</label>
                                <input type="email" class="form-control required email" maxlength="40" id="InputEmail" placeholder="Enter email" required>
                            </div>
                            <div class="form-group">
                                <label for="InputPassword1">Password</label>
                                <input type="password"  class="form-control required passwords" id="InputPassword1" pattern=".{6,12}" required title="Allowed characters from 6 to 12" placeholder="Password" maxlength="12">
                            </div>
                            <div class="form-group">
                                <label for="InputPassword2">Password Confirm</label>
                                <input type="password"  class="form-control required passwords" id="InputPassword2" pattern=".{6,12}" required title="Allowed characters from 6 to 12" placeholder="Password" maxlength="12">
                            </div>                            
                            <br>
                            <p><button id="store" type="submit" onclick="regUser()" class="btn btn-success">Register</button></p>
                            

            </div>
        </div>
        </div>
        <div id="confirmation" class="hide">
         <div class="well">    
            <h4>Please confirm the PIN you have recieved by sms</h4>
         </div>    
                <div class="form-group">
                <label for="PIN">PIN</label>
                <input class="form-control required" id="PIN" maxlength="6" placeholder="Enter your PIN" required>
                </div>
            <button id="store" type="submit" onclick="pinConfirm()" class="btn btn-success">Confirm</button>
        </div>
        <div id="results"></div>
<div id="push"></div>   
    </div>    <!-- wrap -->
    </div> <!-- /container -->        
    
    <script src="js/jquery.js" type="text/javascript"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.1.js"><\/script>')</script>

        <script src="js/vendor/bootstrap.min.js"></script>

<!--        <script src="js/main.js"></script>-->

        <script type="text/javascript">
         
         function validatePhone(phone){
             var phoneno =  /^\d{12}$/
             return phoneno.test(phone);
         }
            
            
         function validateEmail(email) {
                var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            }

            function clearFields() {
                $('#InputPassword1').val('');
                $('#InputPassword2').val('');
                $('#InputEmail').val('');
                $('#InputName').val('');
                $('#InputSName').val('');
                $('#InputPhone').val('');
               
            }
            
            function phoneConfirmation(){
                $("#signupform").addClass("hide");
                $("#confirmation").removeClass("hide");
            }



function regUser(){
                    var name = document.getElementById('InputName').value;
                var surname = document.getElementById('InputSName').value;
                var email = document.getElementById('InputEmail').value.toLowerCase();
                var password1 = document.getElementById('InputPassword1').value;                
                var password2 = document.getElementById('InputPassword2').value;                
                var password1Length = password1.length;
                var JSONdata = '{ "name":"'+name+'","surname":"'+surname+'","email":"'+email+'","password1":"'+password1+'","password2":"'+password2+'", "project": "movesmart"}';
                var url = 'http://'+server+'/registerUser';

                if (!validateEmail(email)) {
                    alertify.alert("Not vaild email address");
                    $('#InputEmail').val('');
                } else {
                    if (password1 != password2) {
                        alertify.alert("passwords do not match");
                        $('#InputPassword1').val('');
                        $('#InputPassword2').val('');
                    } else {
                        if (password1Length < 6 || password1Length > passwordSizeMax || password1Length < passwordSizeMin ) {
                            alertify.alert("Password length shoould be between "+passwordSizeMin+" and "+passwordSizeMax+" characters long");                            
                            $('#InputPassword1').val('');
                            $('#InputPassword2').val('');
                        } else{
                                
                                ajaxWorker.postMessage([url,JSONdata]);
                                ajaxWorker.onmessage= function(e){                                        
                                if(e.data==0){
    	                         showAlertBootbox("A network error occurred when trying to register. Please try again.","Network error");
	                            }else{
		                            var data=JSON.parse(e.data);
                                    var code=data.code;
                                    var message=data.message;
                                    if(code=='1'){
                                                bootbox.dialog({
                                                closeButton: false,
                                                className: modalClass,
                                                title: "Registration was successful",
                                                animate: false,
                                                backdrop: false,
                                                message: message,
                                                buttons: {
                                                success: {
                                                label: "Ok",
                                                className: "btn-success",
                                                callback: function () {
                                                callAnothePage("index.html");
                                                bootbox.hideAll();                     
                                                            }
                                                        }
                                                    }
                                                });
                                    }else{
                                        showAlertBootbox(message,"Error");
                                        }
	                            }
                                
                                }
                        
                                
                        }//end of 1st ELSE
                    }//end of 2rd ELSE
                }//end of 3rd ELSE   
    
}

        </script>

    <script src="js/config.js"></script> 
    <script src="js/vendor/bootbox.js"></script>     
    </body>
</html>
